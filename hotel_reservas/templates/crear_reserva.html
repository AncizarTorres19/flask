{% extends 'base.html' %}

{% block title %}Reservar Habitación {{ habitacion.numero }}{% endblock %}

{% block content %}
<div class="card">
    <h1>Reservar Habitación {{ habitacion.numero }}</h1>
    <p class="muted">{{ habitacion.tipo }} • ${{ "%.2f"|format(habitacion.precio_noche) }} por noche</p>
</div>

<div class="card">
    <form class="form" method="POST">
        <h2>Datos del huésped</h2>
        
        <div class="field">
            <label for="nombre">Nombre completo *</label>
            <input type="text" id="nombre" name="nombre" required placeholder="Juan Pérez">
        </div>
        
        <div class="field">
            <label for="email">Email *</label>
            <input type="email" id="email" name="email" required placeholder="juan@ejemplo.com">
        </div>
        
        <div class="field">
            <label for="telefono">Teléfono</label>
            <input type="tel" id="telefono" name="telefono" placeholder="+54 11 1234-5678">
        </div>
        
        <h2 style="margin-top: 24px;">Detalles de la reserva</h2>
        
        <div class="field">
            <label for="check_in">Fecha de entrada *</label>
            <input type="date" id="check_in" name="check_in" required 
                   min="{{ (now or '').strftime('%Y-%m-%d') if now else '' }}">
        </div>
        
        <div class="field">
            <label for="check_out">Fecha de salida *</label>
            <input type="date" id="check_out" name="check_out" required>
        </div>
        
        <div class="field">
            <label for="num_huespedes">Número de huéspedes *</label>
            <input type="number" id="num_huespedes" name="num_huespedes" 
                   min="1" max="{{ habitacion.capacidad }}" value="1" required>
            <small class="muted">Capacidad máxima: {{ habitacion.capacidad }} {{ 'persona' if habitacion.capacidad == 1 else 'personas' }}</small>
        </div>
        
        <div class="btn-group">
            <a href="{{ url_for('index') }}" class="btn btn-ghost">Cancelar</a>
            <button type="submit" class="btn btn-primary">Confirmar Reserva</button>
        </div>
    </form>
</div>

<script>
// Actualizar fecha mínima de check-out cuando cambia check-in
document.getElementById('check_in').addEventListener('change', function() {
    const checkIn = new Date(this.value);
    checkIn.setDate(checkIn.getDate() + 1);
    const minCheckOut = checkIn.toISOString().split('T')[0];
    document.getElementById('check_out').min = minCheckOut;
});
</script>
{% endblock %}
